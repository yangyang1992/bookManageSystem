<!DOCTYPE html>
<html>
<head>
    <title>图书管理系统-注册</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <script src="js/jquery-1.10.2.js" type="text/javascript"></script>
    <script src="js/config.js" type="text/javascript"></script>
<script type="text/javascript">
    $(document).ready(function() {
        $.post($.URL.anonymous.validateImage,null,imageCallBack,"json");
        //$("#imageCode").attr("src","image/offline.png");
    });
    function imageCallBack(data) {
        console.log(data.data.toString());
        $("#imageCode").attr("src", $.URL.common.rootPath+data.data.toString());
    }
   function commit(){
       if($("#password2").val()==$("#password").val()){
           var username= $("#username").val();
           var passord= $("#password").val();
           var sex;
           if($("#male").checked ==true) {
               sex= $("#male").val();
           }else {
               sex=$("#female").val();
           }
           $.post($.URL.anonymousUser.add,{"username":username,"password":passord,"sex":sex},commitCallBack,"json");
       }else{
           alert("两次输入密码不一样！");
       }

    }

   function commitCallBack(data){
       if(data.code==200){
           alert("注册成功！");
           jump();
       }else{
           alert("注册失败，用户名已存在！");
       }
   }

   function jump() {
       window.location.href="login.html";
   }

</script>
</head>
<body>
<div id="layout-register">
    <table>
        <tr>
            <td>用户名：</td>
            <td><input id="username" name="j_username" type="text"></td>
        </tr>
        <tr>
            <td>密码：</td>
            <td><input id="password" name="j_password" type="password"></td>
        </tr>
        <tr>
        <td>确认密码：</td>
        <td><input id="password2" name="j_password" type="password"></td>
        </tr>
            <tr>
                <td>
            <input type="radio" name="sex" value="男" id="male" checked="checked" />男
            <br />
            <input type="radio" name="sex" value="女" id="female" checked="checked" />女
                </td>
        </tr>
        <tr>
            <td><input type="submit"  value="确认" onclick="commit()"/> </td>
            <td></td>
        </tr>
        <tr>
            <td id="loginMsg" colspan="2"></td>
        </tr>
    </table>

    <img  width="70" height="30"
          alt="验证码" title="点击更换" id="imageCode" style="cursor: pointer;"/>
</div>
</body>
</html>